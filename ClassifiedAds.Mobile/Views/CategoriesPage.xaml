<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:ClassifiedAds.Mobile.ViewModels"
             x:Class="ClassifiedAds.Mobile.Views.CategoriesPage"
             BackgroundColor="{AppThemeBinding Light={StaticResource PageBgLight}, Dark={StaticResource PageBgDark}}"
             Title="Home">

    <ContentPage.BindingContext>
        <vm:CategoriesViewModel />
    </ContentPage.BindingContext>

    <Shell.NavBarIsVisible>False</Shell.NavBarIsVisible>

    <Grid RowDefinitions="Auto, *">

        <Grid Grid.Row="0" ZIndex="2">

            <Grid BackgroundColor="{StaticResource BrandOrange}" Padding="0,0,0,50">
                <VerticalStackLayout Spacing="15" Padding="20,50,20,40">
                    <Label Text="Find the best deals for you" 
                           TextColor="{StaticResource TextInverse}" 
                           HorizontalOptions="Center" 
                           FontSize="16"/>

                    <Button Text="+ POST NEW AD"
                            Command="{Binding PostAdCommand}"
                            BackgroundColor="{AppThemeBinding Light={StaticResource CardBgLight}, Dark={StaticResource CardBgDark}}"
                            TextColor="{StaticResource BrandOrange}"
                            FontAttributes="Bold"
                            CornerRadius="8"
                            HeightRequest="50">
                        <Button.Shadow>
                            <Shadow Brush="Black" Offset="0,4" Radius="5" Opacity="0.2"/>
                        </Button.Shadow>
                    </Button>
                </VerticalStackLayout>
            </Grid>

            <Frame VerticalOptions="End"
                   Margin="20,0,20,-25"
                   BackgroundColor="{AppThemeBinding Light={StaticResource CardBgLight}, Dark={StaticResource CardBgDark}}"
                   CornerRadius="10"
                   Padding="10,0"
                   HasShadow="True"
                   HeightRequest="50"
                   BorderColor="Transparent">
                <Grid ColumnDefinitions="30, *">
                    <Image Grid.Column="0" Source="dotnet_bot.png" Aspect="AspectFit" HeightRequest="20"/>

                    <Entry Grid.Column="1" 
                           Placeholder="Search by item, car, or part..." 
                           TextColor="{AppThemeBinding Light={StaticResource TextPrimaryLight}, Dark={StaticResource TextPrimaryDark}}"
                           PlaceholderColor="{AppThemeBinding Light={StaticResource TextSecondaryLight}, Dark={StaticResource TextSecondaryDark}}"
                           VerticalOptions="Center"
                           ReturnCommand="{Binding SearchCommand}"
                           BackgroundColor="Transparent" />
                </Grid>
            </Frame>
        </Grid>

        <CollectionView Grid.Row="1" 
                        ItemsSource="{Binding Categories}"
                        SelectionMode="Single"
                        Margin="0,35,0,0" 
                        ZIndex="1">

            <CollectionView.ItemsLayout>
                <LinearItemsLayout Orientation="Vertical" ItemSpacing="10"/>
            </CollectionView.ItemsLayout>

            <CollectionView.Header>
                <BoxView HeightRequest="10" Color="Transparent"/>
            </CollectionView.Header>
            <CollectionView.Footer>
                <BoxView HeightRequest="20" Color="Transparent"/>
            </CollectionView.Footer>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame BackgroundColor="{AppThemeBinding Light={StaticResource CardBgLight}, Dark={StaticResource CardBgDark}}"
                           CornerRadius="8"
                           Padding="15"
                           Margin="15,0"
                           HasShadow="True"
                           BorderColor="Transparent"
                           HeightRequest="80">
                        <Grid ColumnDefinitions="80, *">
                            <Image Grid.Column="0" 
                                   Source="{Binding ImageSource}" 
                                   Aspect="AspectFit"/>

                            <Label Grid.Column="1" 
                                   Text="{Binding Title}" 
                                   TextColor="{AppThemeBinding Light={StaticResource TextPrimaryLight}, Dark={StaticResource TextPrimaryDark}}"
                                   FontSize="18"
                                   FontAttributes="Bold"
                                   VerticalOptions="Center"
                                   Margin="15,0,0,0"/>
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentPage>